function traceit(e){}function initIngage(e){__setupParams(e);if(__checkIDevices())return;var t=navigator.userAgent.toLowerCase();if(t.indexOf("safari")!=-1){if(t.indexOf("chrome")>-1){isSafari=false}else{isSafari=true}}if(__checkFrequency()){if(!isSafari)__addIframe();else{window.onload=function(){__setupSafariVersion()}}__initListeners()}}function __checkIDevices(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)}function __checkFrequency(){var e=getCookie();var t;try{t=JSON.parse(e)}catch(n){setCookie(1);return true}if(t){var r=Number(t["inview_loaded"]);if(r%freq==0){setCookie(1);return true}setCookie(r+1);return false}return false}function setCookie(e){document.cookie=COOKIE_NAME+elementId+'={"inview_loaded":"'+e+'"}; expires=10000; path=/'}function getCookie(){var e=new RegExp("[; ]"+COOKIE_NAME+elementId+"=([^\\\\s;]*)");var t=(" "+document.cookie).match(e);if(COOKIE_NAME+elementId&&t)return unescape(t[1]);return""}function __setupParams(e){elementId=e.elementId;adTag=e.adTag;flashHeight=e.height;flashWidth=e.width;delimiter=e.p_delimiter;freq=e.freq!=0?e.freq:1;playControl=e.useViewabilityForAd;soundControl=e.useVolumeForAd;secondsToPlay=e.secondsToPlay;scrLoc=e.scrLoc;if(e.ga){gaId=e.ga.id;gaShouldTrack=gaId&&gaId!="";gaLabel=e.ga.label}}function __addIframe(){divForAppend=document.getElementById(elementId);traceit("DIV append: "+divForAppend.offsetHeight);divWithIframe=document.createElement("div");divWithIframe.id="adplayer_iframeDiv";divWithIframe.style.position="relative";divWithIframe.style.height="0px";divWithIframe.style.width=flashWidth+"px";divWithIframe.style.overflow="hidden";iframe=document.createElement("iframe");iframe.src="http://"+scrLoc+".springboardplatform.com/storage/js/ingage/main.html"+"?width="+flashWidth+"&height="+flashHeight+"&soundControl="+soundControl+"&host="+document.referrer+"&playControl="+playControl+"&secondsToPlay="+secondsToPlay+"&gaId="+gaId+"&gaLabel="+gaLabel+"&srcLoc="+scrLoc+"&adTag="+adTag+"ing_sb_adtag";iframe.id="adPlayer_ingage";iframe.width=flashWidth;iframe.height=flashHeight;iframe.scrolling="no";iframe.style.border="0px";iframe.style.width=flashWidth+"px";iframe.style.height=flashHeight+"px";iframe.style.frameBorder=0;iframe.style.overflow="hidden";iframe.style.align="left";iframe.style.position="relative";iframe.style.display="block";iframe.style.top="-5000px";divWithIframe.appendChild(iframe);__appendDivWithIFrame();readyInterval=window.setInterval(function(){sendToPostMessage("AdsPlayer|readyState")},100)}function __appendDivWithIFrame(){var e=divForAppend.getElementsByTagName("p");var t=e.length;var n;var r=divForAppend;for(var i=0;i<t;i++){n=e[i].parentNode;while(n){if(n==divForAppend){divArray.push(e[i]);break}n=n.parentNode}}t=divArray.length;if(delimiter<t){var s=divArray[delimiter];s.parentNode.insertBefore(divWithIframe,s)}else{divForAppend.appendChild(divWithIframe)}}function __removeIframe(){try{if(!isSafari)divWithIframe.removeChild(iframe);else{divToMove.removeChild(divWithFlash);divWithIframe.removeChild(divToMove)}}catch(e){traceit("err removing iframe "+e)}try{divForAppend.removeChild(divWithIframe)}catch(t){traceit("error removing div "+t);var n=divArray[delimiter];n.parentNode.removeChild(divWithIframe)}}function __checkIfReadyForSafari(e){traceit("TYPE : "+e+"  load "+__initialLoad+"  scroll: "+__initialScroll);__initialScroll=e=="scroll";__initialLoad=e=="load"}function __initListeners(){window.onscroll=function(){scrollCheck();if(!__initialScroll){__initialScroll=true}};window.onresize=function(){scrollCheck()}}function __destroyListeners(){window.onscroll=undefined;window.onresize=undefined}function __killAd(){traceit("KILL AD");completed=true;__destroyListeners();window.clearInterval(readyInterval);traceit("isSafari  "+isSafari+"  "+expanded);if(!isSafari)iframe.style.top="-5000px";if(expanded){prevDivHeight=divWithIframe.style.height;slideUpInterval=setInterval(function(){collapseDiv()},20)}else __removeIframe()}function postMessageResponse(e){traceit("ingage postMessage: "+e.data+"  origin: "+e.origin);if(e.data.indexOf("AdsPlayer")!=-1){traceit("ingage postMessage: "+e.data+"  origin: "+e.origin);var t=e.data.split("|");traceit(t);if(t[0]=="AdsPlayer"){switch(t[1]){case"ready":window.clearInterval(readyInterval);isEverythingReady=true;scrollCheck();break;case"completed":__killAd();break}}}}function sendToPostMessage(e,t){traceit("send to postMessage from ingage "+e);if(iframe&&iframe.contentWindow){iframe.contentWindow.postMessage(e,"*")}}function expandDiv(){var e=parseInt(divWithIframe.style.height);traceit("divWithIframe width: "+divWithIframe.style.width+"   "+divWithIframe.offsetWidth+"   "+divForAppend.offsetWidth);if(e+20>flashHeight){e=flashHeight;clearInterval(slideDownInterval);if(!isSafari)iframe.style.top="0px";else __embedFlash()}else{e=e+20}divWithIframe.style.height=e+"px"}function collapseDiv(){var e=parseInt(divWithIframe.style.height);traceit("collapseDiv   "+e);if(e-20<0){e=0;clearInterval(slideUpInterval);window.clearTimeout(checkCollapseInterval);__removeIframe()}else{e=e-20}if(divWithIframe){divWithIframe.style.height=e+"px";traceit("divWithIframe height: "+divWithIframe.style.height+"   "+divWithIframe.offsetHeight+"   "+divForAppend.offsetHeight);traceit("divWithIframe width: "+divWithIframe.style.width+"   "+divWithIframe.offsetWidth+"   "+divForAppend.offsetWidth);__checkIfCollapsed()}}function __checkIfCollapsed(){if(divWithIframe.style.height==prevDivHeight&&divWithIframe.style.height!="0px"){clearInterval(slideUpInterval);__removeIframe();divWithIframe.style.height="0px"}else{prevDivHeight=divWithIframe.style.height}}function scrollCheck(){traceit("scrollCheck: isEverythingReady "+isEverythingReady);if(!isEverythingReady)return;var e=checkIfVisible();if(e!=elementVisible){elementVisible=e;if(elementVisible){if(secondsToPlay>0)playInterval=setTimeout(function(){playAd()},secondsToPlay);else playAd()}else{clearTimeout(playInterval);if(!isSafari)sendToPostMessage("AdsPlayer|visible|"+elementVisible);else contactFlash("visible",elementVisible)}}}function playAd(){if(!expanded){expanded=true;slideDownInterval=setInterval(function(){expandDiv()},20)}if(!isSafari)sendToPostMessage("AdsPlayer|visible|"+elementVisible);else contactFlash("visible",elementVisible)}function checkIfVisible(){var e=getViewportHeight();var t=getViewportWidth();var n=scrollYValue();var r=scrollXValue();var i=getFixed();var s=posY();var o=posX();var u=downLimit=s+flashHeight*.5;var a=leftLimit=o+flashWidth*.5;var f=u<e+n;var l=downLimit-n>i;return f&&l}function getViewportHeight(){var e=document.documentElement;if(!!window.innerHeight)return window.innerHeight;else if(e&&!isNaN(e.clientHeight))return e.clientHeight;return 0}function getViewportWidth(){var e=document.documentElement;if(!!window.innerWidth)return window.innerWidth;else if(e&&!isNaN(e.clientWidth))return e.clientWidth;return 0}function scrollYValue(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function scrollXValue(){if(window.pageXOffset){return window.pageXOffset}return Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}function getFixed(){var e=0;if(/IE/i.test(navigator.userAgent))return 0;var t=Array.prototype.slice.call(document.getElementsByTagName("div"));var n=Array.prototype.slice.call(document.getElementsByTagName("header"));if(n){for(var r=0;r<n.length;r++){var i=n[r].getElementsByTagName("div");if(i){for(var s=0;s<i.length;s++){for(var o=0;o<t.length;o++){if(t[o].isEqualNode(i[s])){t.splice(o,1);break}}}}}}for(var r=0;r<n.length;r++){if(checkHeader(n[r])){e+=n[r].offsetHeight}}for(var s=0;s<t.length;s++){if(checkDiv(t[s])){e+=t[s].offsetHeight}}return e}function checkHeader(e){return e.offsetTop==0&&e.offsetHeight!=0&&getStyle(e,"display")!="none"&&checkWidth(e)}function checkDiv(e){return Number(getStyle(e,"z-index"))>0&&e.offsetTop==0&&e.offsetHeight!=0&&getStyle(e,"display")!="none"&&getStyle(e,"position")=="fixed"&&checkWidth(e)&&getStyle(e,"visibility")!="hidden"}function getStyle(e,t){var n;if(e.currentStyle)n=e.currentStyle[t];else if(window.getComputedStyle)n=document.defaultView.getComputedStyle(e,t).getPropertyValue(t);return n}function checkWidth(e){return document.body.offsetWidth==e.offsetWidth}function posY(){var e=divWithIframe;var t=0;while(!!e&&e.tagName.toLowerCase()!=="body"){t+=e.offsetTop;e=e.offsetParent}return t}function posX(){var e=divWithIframe;var t=0;while(!!e&&e.tagName.toLowerCase()!=="body"){t+=e.offsetLeft;e=e.offsetParent}return t}function __setupSafariVersion(){var e=document.createElement("script");e.type="text/javascript";e.onload=function(){traceit("setup safari version");if(gaShouldTrack)__setupSafariGA();__setupSafariFlash()};e.src="http://"+scrLoc+".springboardplatform.com/storage/js/ingage/swfobject.js";document.body.appendChild(e)}function __setupSafariGA(){(function(e,t,n,r,i,s,o){e["GoogleAnalyticsObject"]=i;e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date;s=t.createElement(n),o=t.getElementsByTagName(n)[0];s.async=1;s.src=r;o.parentNode.insertBefore(s,o)})(window,document,"script","//www.google-analytics.com/analytics.js","gooan");gooan("create",gaId,"auto");gooan("send","pageview")}function gaTrackSafari(e){if(!gaShouldTrack)return;if(gooan){gooan("send","event",gaLabel,e)}}function __setupSafariFlash(){divForAppend=document.getElementById(elementId);divToMove=document.createElement("div");divToMove.style.position="relative";divToMove.style.width=flashWidth+"px";divToMove.style.height=flashHeight+"px";divToMove.id="div_move";divToMove.style.display="block";divWithFlash=document.createElement("div");divWithFlash.style.position="relative";divWithFlash.id="div_flash";divWithFlash.style.overflow="hidden";divWithFlash.style.width=flashWidth+"px";divWithFlash.style.height=flashHeight+"px";divWithFlash.style.display="block";divWithIframe=document.createElement("div");divWithIframe.id="adplayer_iframeDiv";divWithIframe.style.height="0px";divWithIframe.style.width=flashWidth+"px";divWithIframe.style.overflow="hidden";divWithIframe.style.display="block";divToMove.appendChild(divWithFlash);divWithIframe.appendChild(divToMove);__appendDivWithIFrame();isEverythingReady=true;traceit("READY");scrollCheck()}function contactFlash(e,t){var n=document.getElementById("div_flash");if(e=="visible"){try{if(t)n.playAd();else n.pauseAd()}catch(r){}}}function __embedFlash(){var e={};e.width=flashWidth;e.height=flashHeight;e.adTag=escape(adTag);e.ingage=true;e.soundControl=soundControl;e.playControl=playControl;e.host=document.referrer;e.isSafari=isSafari;var t="http://"+scrLoc+".springboardplatform.com/storage/js/ingage/AdsPlayer.swf";traceit("SAAAFARI "+t);var n={};n.wmode="transparent";n.movie=t;n.allowscriptaccess="always";n.allowFullScreen="true";var r={};r.classid="D27CDB6E-AE6D-11cf-96B8-444553540000";r.width=flashWidth;r.height=flashHeight;r.movie=t;r.id="attFlashIdName";r.name="attFlashIdName";r.allowscriptaccess="always";swfobject.embedSWF(t,"div_flash",flashWidth,flashHeight,"10.0.0","expressInstall.swf",e,n)}function setAdStatusSafari(e){gaTrackSafari(e);if(e=="allAdsCompleted"||e.indexOf("error")!=-1){if(!completed){__killAd()}}else if(e.indexOf("loaded")!=-1){isEverythingReady=true;if(isSafari){if(elementVisible){var t=document.getElementById("div_flash");t.playAd()}}else scrollCheck()}}if(SbInGageWidget==undefined){var SbInGageWidget={options:{cmsPath:"http://dev.publishers.springboardplatform.com"},init:function(e){var t=SbInGageWidget.clone(SbInGageWidget.options);t=SbInGageWidget.extend(t,e);SbInGageWidget.options=t;this.makeCall()},clone:function(e){if(!e||typeof e!="object"){return e}var t=new e.constructor;for(var n in e){if(e.hasOwnProperty(n)){t[n]=SbInGageWidget.clone(e[n])}}return t},extend:function(e,t){for(var n in t){if(typeof e[n]=="object"){e[n]=SbInGageWidget.extend(e[n],t[n])}else{e[n]=t[n]}}return e},makeCall:function(){var e=this.options.cmsPath+"/ingage/getJson/"+this.options.partnerId+"/"+this.options.widgetId;var t=document.getElementsByTagName("head").item(0);var n=document.createElement("script");n.setAttribute("type","text/javascript");n.setAttribute("src",e);n.async=true;t.appendChild(n)}}}var COOKIE_NAME="ads_player_ingage_";var elementId;var adTag="";var freq=1;var delimiter;var flashWidth=100;var flashHeight=100;var playControl;var soundControl;var secondsToPlay=0;var scrLoc="dev";var gaId="";var gaLabel="";var iframe;var divArray=[];var divWithIframe;var divForAppend;var elementVisible=false;var isEverythingReady=false;var readyInterval;var completed=false;var expanded=false;var slideDownInterval;var slideUpInterval;var checkCollapseInterval;var playInterval;var lastPlayAction=0;var prevDivHeight=0;var isSafari=false;var __initialScroll=false;var __initialLoad=false;var alreadyrunflag=0;if(window["addEventListener"]){window.addEventListener("message",postMessageResponse,false)}else{window.attachEvent("onmessage",postMessageResponse)}